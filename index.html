<!doctype HTML>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Local Stories</title>

<head>
  <script src="//use.typekit.net/vct1gvu.js"></script>
  <script>
    try {
      Typekit.load();
    } catch (e) {}
  </script>
  <link rel="stylesheet" href="style.css" />

  <body>
    <section>
      <h1>Local Stories</h1>
      <h2>A markup library for creating dynamic stories relative to a reader's place, time, location and weather.</h2>
      <h3>Introduction</h3>
      <p>Local Stories is a tool created by <a href="https://twitter.com/FilipNest">Filip Hn&#237;zdo</a> to localise text for its reader. It was created for making relative fiction that changes depending on where a reader is, what the weather is like and what time of day or year it is.</p>
      <p>It can hopefully be used for many other things and is looking for writers to help work out how best to use it and how it can be improved. This could be you. It could be exciting.</p>
      
      <nav class="landing">
      <a href="here/index.php">Go here to read some stories a group of writers wrote to mark its launch and submit your own story.</a>
      <a href="https://github.com/FilipNest/localstories">Go here to download the code and use it in your own projects, report bugs, make suggestions or contribute to its development. The code is open source and free to use.</a>
      </nav>
      
        Read on to find out how it works...
        
      <h3>How it works</h3>

      <p>A writer writes a story and at certain points, replaces static words like days of the week and place names with special placeholders or <em>variables</em>.</p>
      <p>What kinds of variables can be used and how they work is covered in detail below. But first, here is an example of how a piece of text might look before it is converted for a reader:</p>
      
      <div class="codeblock">
      
        I love <span class="code">[dayofweek]</span>s. It was around <span class="code">[hours12][hoursampm]</span> on a <span class="code">[dayofweek]</span> when I first saw its outlines. I was sitting in <span class="code">[park|1]</span> and looking out at the sky. It was a <span class="code">[weather]</span> day much like this one. Wings. Clearly a pair of wings. Floating somewhere towards <span class="code">[supermarket|1|street]</span> as if going about their everyday business. This month is even more special. It happened in <span class="code">[monthofyear]</span>. So I walk over to <span class="code">[park|1]</span> and look out. But there's never anything anymore...
      
      </div>
      
      <p>Alongside variables, writers can put in logic to show text if some statements are true and some other text if they are not.</p>
      <p>Say you are writing a piece of science fiction and you get frustrated by the thought of the year you chose arriving too quickly, thereby making your choice of date laughabily ancient.</p>
      <p>You hope they'll have jetpack factories in 2035 but don't know for sure, so you write a conditional statement that sets the story 30 years in the future, unless there's already a jetpack factory around the corner from where the reader is.</p>
      <div class="codeblock">
        
        It was <span class="code">{if +[jetpack factory|1|distance]<5000|[year]|[year|+30]}</span>AD. I returned the jetpack I'd borrowed. I never got on with those things.

      </div>
        <small>You'll probably find conditionals are most useful for things like the weather, time of day, country or the distance to the nearest beach.</small>
        
        <p>Once a reader starts reading a story and agrees to share their location (longitude and latitude picked up through their web browser), all relevant data is collected and swapped out to make a story that is unique to that reader but still keeps the original essense of the story.</p> 
      
        <p>Data for places is pulled in from <a href="http://foursquare.com">Foursquare</a>, a wonderful place-based social network and directory. Data for weather and sunset and sunrise times is brought in from the kind people who run <a href="http://openweathermap.org">OpenWeatherMap</a>.</p>
        
        <p><small>Side note: As mentioned, the tool can be used for more than just fiction, it should work on HTML so you might even be able to use it in your application to show pictures, video or other data relevant to a viewer/reader.</small></p>

      <h3>Types of variable</h3>
      <h4>Places</h4>
      <p>To put a place in your story, a zoo or japanese restaurant for example, first look up the name of the category of place on <a href="https://developer.foursquare.com/categorytree">this list of place categories from Foursquare</a> to make sure it's available. The list used to match place categories in text is updated live from this Foursquare list so if squirrel cafes (or jetpack factories) suddenly become a huge thing they might be a useable variable in the future. Parent categories contain everything below them so you can use them to get less specific variables.</p>
      <p>Next, enclose the name of the category in square brackets followed by a | (pipe) character and a unique number for that place. The number is there in case you want to re-use the same place in multiple parts of the story or have multiple places of the same category.</p>

      <div class="codeblock">
        We went out for a few drinks at <span class="code">[nightclub|1]</span> and somehow ended up naked and shivering in the waters of the <span class="code">[river|1]</span>
      </div>
      <small>The locations will get swapped out by the location of that category nearest to the reader. The word "The" is stripped out if a place starts with it.</small>
      </p>
      <h4>Other information about places</h4>
      <p>You might want to use other information about a place, like the street it's on or how far away it is from the reader.</p>
      <p>If you've got how places work this bit should be easy as it's just another pipe character after the ID.</p>
      <div class="codeblock">
        He lived on <span class="code">[park|1|street]</span>. I never liked that part of town after what happened to Emily.</div>
      <small>Putting the word "street" after the pipe will get translated to the street the venue is on. Parts of street names containing numbers are stripped out (11,33b...). If there's no street set it defaults to "The Street". Might be useful for providing a general street for things to happen in.</small>

      <div class="codeblock">
        She arranged to meet me at <span class="code">[zoo|1]</span>. For some reason she never wanted to see me more than <span class="code">[zoo|1|distance]</span> meters from an animal park.
      </div>
      <small>Distance in meters from a reader's location to a place. Useful for conditionals like if you want to find out how far someone is from the sea.</small>

      <div class="codeblock">
        I love coming back to the smell of <span class="code">[park|1|city]</span>. It reminds me of that night in <span class="code">[chinese restaurant|1]</span> all those years ago.
      </div>
      <small>The city or town the venue is in. Defaults to "The City" if the venue doesn't have one set.</small>

      <h4>Other variables</h4>
      <p>It's not just places you can swap into text, here are some other variables you can use.</p>

      <div class="codeblock">
        It was <span class="code">[dayofweek]</span>. She always came round on <span class="code">[dayofweek]</span>s. Yesterday would have been better. <span class="code">[dayofweek|-1]</span>s were always better than <span class="code">[dayofweek]</span>s.
      </div>
      <small>The day of the week. Monday, Tuesday... etc. Add a pipe character followed by a positive or negative number to add or substract days.</small>
      <div class="codeblock">
        <span class="code">[hours12][hoursampm]</span>. If only I had set my alarm to <span class="code">[hours12|-2]</span>:<span class="code">[minutes|+30][hoursampm|-1]</span>. It may have saved my life. The dial read <span class="code">[hours24]</span>:<span class="code">[minutes]</span> and it was over.
      </div>
      <small>Various ways of getting times of day. <b>hoursampm</b> returns am if it's before noon and pm if after. It can be offset by adding positive or negative hours after a pipe character. <b>hours24</b> and <b>hours12</b> return the current hour in either 24 hour time or 12 hour time. They can also be offset by positive or negative hours. <b>minutes</b> returns the current time in minutes. Add positive or negative minutes after a pipe to add or subtract minutes from the time.</small>
      <div class="codeblock">
        It was <span class="code">[monthofyear]</span>. Five years after they caught the fish. I still have the newspaper cuttings from <span class="code">[monthofyear] [dayofmonth][dayofmonthsuffix]</span>, <span class="code">[year|-5]</span>.
      </div>
      <small>Get the current month or current year. You can add a pipe followed by a positive/negative count of months/years to set it forward or back in time. <b>dayofmonth</b> returns the day of the month in number form (you can offset this by days after a pipe character). <b>dayofmonthsuffix</b> gives you the English language suffix for that day "th","st","rd" or "nd". It also works with day offsets</small>
      <div class="codeblock">
        <span class="code">[longitude]</span>,<span class="code">[latitude]</span> said the screen. This was the right place. It's what it said on the paper. But my instinct told me <span class="code">[country]</span> wasn't even the right part of the world.
      </div>
      <small>Longitude and latitude for those who need it. Also a country name from <a href="https://gist.github.com/vxnick/380904">this handy PHP array mapping country codes to names.</a></small>

      <div class="codeblock">

        It was a <span class="code">[weather]</span> day like this one when my ears stopped working.

      </div>
      <small>The reader's current weather. This can return one of the following values: stormy, rainy, snowy, clear, cloudy, calm, windy, scorching, freezing. You can re-write them using conditionals.</small>

      <div class="codeblock">

        It could only happen exactly at sunset. <span class="code">[sunsethour]</span> hundred hours. That was <span class="code">[hourstosunset]</span> hours away.

      </div>
      <small>Hour (in 24 hour time) of the next sunset. You can also use <b>hourstosunset</b> to get how much time until the next sunset. Both useful in conditionals.</small>
      <div class="codeblock">

        It could only happen exactly at sunrise. <span class="code">[sunrisehour]</span> hundred hours. That was <span class="code">[hourstosunrise]</span> hours away.
      </div>
      <small>Same as sunset but for sunrise. See above.</small>

      <p>More variables will come in the future but that should hopefully give you a nice start. Please feel free to suggest some if you feel anything is missing.</p>

      <h3>Conditionals</h3>

      <p>Conditionals are the most complex part of the system but hopefully not so complex that you don't try them out as they're probably the best part of it.</p>
      <p>They're enclosed in curly brackets with the word <em>if</em> followed by a space after the opening bracket.</p>
      <p>After this space and before the second bracket, you can put in statements that should either be true or false. First decide if a statement should be true or false and put in a + or a - sign. Then put in the name of the value you wish to compare to something (this can be static such as the number 5 or dynamic such as [sunsethour]). Then put in an operator from either == (equals (two == signs)), > (greater than) or
        < (less than).</p>
          <p>Then put the name of the value you want to use this operator to compare the first value to. This can be static text or a dynamic variable.</p>
          <p>Put in as many of these rules as you want seperated by commas.</p>
          <p>Then put in a pipe character | followed by what you want to write if this set of rules passes.</p>
          <p>Then put in another pipe character | followed by what to write if the rule does not pass.</p>
          <p>Finally, close the curly bracket.</p>
          <p>Here's an example that checks if the reader has missed Wednesday's sunset.</p>
          <div class="codeblock">
            <span class="code">{if +[sunsethour]>[hours24],+[dayofweek]==Wednesday|You can still catch sunset on Wednesday|You missed Wednesday's sunset}</span>
          </div>

          <h3>Live demo</h3>
          <p>Use the following text area to try out text and variables. Once you've put them all in, hit localise and (if you have given your browser permission to use your location) the results should appear above the textarea.</p>
          <p>If you receive any error messages, please tweak and keep trying. If you keep getting error messages and can't see why, get in touch. You may have found a bug.</p>
          <p>Don't hesitate to get in touch if you run into any issues or have any questions.</p>

          <h4>Output</h4>

          <div id="output">
            ---
          </div>
          <br />

          <textarea id="input" placeholder="I love [dayofweek]s. It was around [hours12][hoursampm] on a [dayofweek] when I first saw its outlines. I was sitting in [park|1] and looking out at the sky. It was a [weather] day much like this one. Wings. Clearly a pair of wings. Floating somewhere towards [supermarket|1|street] as if going about their everyday business. This month is even more special. It happened in [monthofyear]. So I walk over to [park|1] and look out. But there's never anything anymore..."></textarea>

          <button id="localise">Localise</button>
    </section>
  </body>

  <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
</head>
<script src="story.js"></script>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63609457-1', 'auto');
  ga('send', 'pageview');

</script>
  
</html>